<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MarketPulse - Real-Time Market Prices</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.2.0/dist/tf.min.js"></script>
</head>
<style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 1rem;
      background: #f0f8ff;
      color: #333;
      text-align: center;
      transition: direction 0.3s;
    }

    h1 {
      color: #2a4d69;
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    p {
      font-size: 1rem;
      margin-bottom: 2rem;
    }

    .form-section {
      background: #fff;
      padding: 1rem;
      margin: 1rem auto;
      max-width: 500px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      text-align: left;
    }

    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }

    select, input[type="number"] {
      width: 100%;
      padding: 0.6rem;
      margin-top: 0.4rem;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-sizing: border-box;
      font-size: 1rem;
    }

    button {
      margin-top: 1rem;
      padding: 10px 15px;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #0056b3;
    }

    .price-box {
      margin: 2rem auto;
      padding: 1rem;
      max-width: 500px;
      background-color: #ffffff;
      border: 2px dashed #ccc;
      border-radius: 12px;
      font-size: 1.2rem;
      color: #222;
    }

    .form-section h2 {
      margin-top: 1rem;
      color: #2a4d69;
    }

    .voice-container {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
  </style>
<body>
  <h1 id="title">üìä MarketPulse</h1>
  <p id="subtitle">Track market prices before heading out</p>  <div class="form-section">
    <label for="language">üåê Language:</label>
    <select id="language" onchange="switchLanguage()">
      <option value="en">English</option>
      <option value="ha">Hausa</option>
      <option value="fr">French</option>
      <option value="yo">Yoruba</option>
      <option value="sw">Swahili</option>
      <option value="ar">Arabic</option>
    </select><label for="market" id="labelMarket">Market Location:</label>
<select id="market">
  <option value="Potiskum">Potiskum</option>
  <option value="Damaturu">Damaturu</option>
  <option value="Maiduguri">Maiduguri</option>
  <option value="Kano">Kano</option>
  <option value="Lagos">Lagos</option>
</select>

<label for="product" id="labelProduct">Product:</label>
<div style="display: flex; gap: 0.5rem; align-items: center;">
  <select id="product"></select>
  <button onclick="voiceInput()">üé§</button>
</div>

<button id="viewBtn" onclick="getPrice()">View Price</button>
<button onclick="predictPrice()">ü§ñ Predict Price</button>

  </div>  <div id="result" class="price-box"></div>  <div class="form-section">
    <h2 id="submitTitle">üì• Submit a Price</h2>
    <input type="number" id="newPrice" placeholder="Enter price in ‚Ç¶">
    <button id="submitBtn" onclick="submitPrice()">Submit</button>
  </div>  
  <script>
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  firebase.database().ref(".info/connected").on("value", function(snapshot) {
    if (snapshot.val() === true) {
      console.log("‚úÖ Firebase is connected");
    } else {
      console.warn("‚ùå Firebase is not connected.");
    }
  });

  const translations = {/* Full translations here */};
  let currentLang = "en";

  function switchLanguage() {
    currentLang = document.getElementById("language").value;
    const t = translations[currentLang];

    document.getElementById("title").innerText = t.title;
    document.getElementById("subtitle").innerText = t.subtitle;
    document.getElementById("labelMarket").innerText = t.marketLabel;
    document.getElementById("labelProduct").innerText = t.productLabel;
    document.getElementById("viewBtn").innerText = t.viewBtn;
    document.getElementById("submitTitle").innerText = t.submitTitle;
    document.getElementById("submitBtn").innerText = t.submitBtn;

    document.body.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
    document.body.style.fontFamily = currentLang === 'ar' ? 'Tajawal, sans-serif' : 'Segoe UI, sans-serif';

    const productSelect = document.getElementById("product");
    productSelect.innerHTML = "";
    Object.keys(t.products).forEach(key => {
      const option = document.createElement("option");
      option.value = key;
      option.text = t.products[key];
      productSelect.appendChild(option);
    });
  }

  function getPrice() {
    const market = document.getElementById('market').value;
    const product = document.getElementById('product').value;
    const refPath = `prices/${market}/${product}`;

    db.ref(refPath).once('value', snapshot => {
      const price = snapshot.val();
      const resultBox = document.getElementById('result');
      const translatedName = translations[currentLang].products[product] || product;
      if (price) {
        resultBox.innerHTML = `<strong>${translatedName}</strong> @ <strong>${market}</strong>: ‚Ç¶${price}`;
      } else {
        resultBox.innerHTML = `No price available for ${translatedName} at ${market}.`;
      }
    });
  }

  function submitPrice() {
    const market = document.getElementById('market').value;
    const product = document.getElementById('product').value;
    const newPrice = document.getElementById('newPrice').value;
    const refPath = `prices/${market}/${product}`;

    if (!newPrice) {
      alert("Please enter a price.");
      return;
    }

    db.ref(refPath).set(Number(newPrice))
      .then(() => {
        alert("Price submitted successfully!");
        getPrice();
      })
      .catch(error => {
        console.error("Error submitting price:", error);
      });
  }

  function voiceInput() {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
      alert("Speech recognition is not supported in your browser.");
      return;
    }

    const recognition = new SpeechRecognition();
    recognition.lang = currentLang === 'ar' ? 'ar-SA' : currentLang === 'fr' ? 'fr-FR' : currentLang === 'ha' ? 'ha-NG' : currentLang === 'yo' ? 'yo-NG' : currentLang === 'sw' ? 'sw-TZ' : 'en-US';
    recognition.onresult = (event) => {
      const spoken = event.results[0][0].transcript.toLowerCase();
      const productOptions = document.getElementById("product").options;
      for (let option of productOptions) {
        if (option.text.toLowerCase().includes(spoken)) {
          option.selected = true;
          break;
        }
      }
    };
    recognition.start();
  }

  async function predictPrice() {
    const product = document.getElementById('product').value;
    const market = document.getElementById('market').value;
    const prices = [];

    const snapshot = await db.ref(`historical/${market}/${product}`).once('value');
    snapshot.forEach(child => prices.push(child.val()));

    if (prices.length < 3) {
      alert("Not enough data to predict.");
      return;
    }

    const xs = tf.tensor2d(prices.map((_, i) => [i]));
    const ys = tf.tensor2d(prices);
    const model = tf.sequential();
    model.add(tf.layers.dense({ units: 1, inputShape: [1] }));
    model.compile({ loss: 'meanSquaredError', optimizer: 'sgd' });

    await model.fit(xs, ys, { epochs: 100 });

    const predicted = model.predict(tf.tensor2d([[prices.length]])).dataSync()[0];
    document.getElementById('result').innerHTML += `<br>üìà Predicted next price: ‚Ç¶${predicted.toFixed(2)}`;
  }

  window.onload = switchLanguage;
  </script>
  </body>
</html>